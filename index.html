<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trinity Episcopal De Soto — Full Calendar</title>
  <meta name="description" content="Complete events calendar for Trinity Episcopal Church, De Soto, MO.">

  <style>
    :root {
      --panel:#ffffff; --ink:#0b1220; --muted:#475569;
      --accent:#16a34a; --accent-2:#2563eb;
      --grid:#64748b; --tint:#f8fafc;
    }
    body {
      margin:0; font-family:ui-sans-serif,system-ui,sans-serif; color:var(--ink);
      background:url("assets/stained-glass.jpg") no-repeat center center fixed;
      background-size:cover;
      position:relative;
    }
    body::before {
      content:""; position:absolute; inset:0;
      background:rgba(255,255,255,0.85); /* soft overlay */
      z-index:0;
    }
    header, main, footer {
      position:relative; z-index:1;
    }
    header {
      background:var(--accent-2); color:#fff; padding:1rem; text-align:center;
    }
    header h1 {margin:0; font-size:1.5rem;}
    header p {margin:0.25rem 0 0; font-size:1rem;}
    main, footer {
      max-width:1000px; margin:1rem auto; padding:1rem;
      background:var(--panel); border-radius:1rem;
      box-shadow:0 2px 6px rgba(0,0,0,0.1);
    }
    #calendar-app {padding:1rem;}
    .badge {display:inline-block; padding:0.25rem 0.5rem; border-radius:6px; color:#fff; font-size:0.75rem;}
    .aa {background:#16a34a;} .na {background:#ea580c;}
    .svc {background:#2563eb;} .holy {background:#facc15; color:#000;}
  </style>
</head>
<body>
  <header>
    <h1>Trinity Episcopal Church — De Soto, MO</h1>
    <p>Complete Calendar of Worship Services, AA/NA Meetings, and Community Events</p>
  </header>

  <main>
    <h2>Calendar</h2>
    <div id="calendar-app">Loading events…</div>
  </main>

  <footer>
    <p><span class="badge aa">AA 148 / 147</span> 
       <span class="badge na">NA</span> 
       <span class="badge svc">Sunday Service</span> 
       <span class="badge holy">Holy Day</span></p>
    <p>Trinity Episcopal Church, 202 W. Miller St., De Soto, MO 63020 · (636) 586-2542</p>
  </footer>

  <script>
    const ASSETS_VERSION = 303;
    const EVENTS_URLS = [
      `assets/events.json?v=${ASSETS_VERSION}`
    ];

    async function loadEvents() {
      let events = [];
      for (const url of EVENTS_URLS) {
        try {
          const res = await fetch(url);
          if (!res.ok) throw new Error(res.status);
          const data = await res.json();
          events = events.concat(data);
        } catch (err) {
          console.error("Failed to load", url, err);
        }
      }
      return events;
    }

    function renderCalendar(events) {
      const container = document.getElementById("calendar-app");
      container.innerHTML = "";
      const ul = document.createElement("ul");
      events.forEach(ev => {
        const li = document.createElement("li");
        li.textContent = ev.title + (ev.start ? " — " + ev.start : "");
        ul.appendChild(li);
      });
      container.appendChild(ul);
    }

    loadEvents().then(events => renderCalendar(events));
  </script>
</body>
</html>
