<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trinity Episcopal De Soto â€” Calendar</title>
  <meta name="description" content="Monthly events & services at Trinity Episcopal Church, De Soto, MO.">

  <style>
    :root {
      --panel:#ffffff; --ink:#0b1220; --muted:#475569;
      --accent:#16a34a; --accent-2:#2563eb;
      --grid:#64748b; --tint:#f8fafc;
    }
    body {
      margin:0; font-family:ui-sans-serif,system-ui,sans-serif; color:var(--ink);
      background:url("assets/stained-glass.jpg") no-repeat center center fixed;
      background-size:cover;
      position:relative;
    }
    body::before {
      content:""; position:absolute; inset:0;
      background:rgba(255,255,255,0.85); /* soft overlay for readability */
      z-index:0;
    }
    header, main, section, footer {
      position:relative; z-index:1;
    }
    header {
      background:var(--accent-2); color:#fff; padding:1rem; text-align:center;
    }
    header h1 {margin:0; font-size:1.5rem;}
    header p {margin:0.25rem 0 0; font-size:1rem;}
    .view-calendar-btn {
      display:inline-block; margin-top:0.75rem; padding:0.5rem 1rem;
      background:#fff; color:var(--accent-2); border-radius:8px;
      text-decoration:none; font-weight:600; transition:background 0.2s;
    }
    .view-calendar-btn:hover {background:#e2e8f0;}
    #calendar, #upcoming, #legend {
      max-width:1000px; margin:1rem auto; padding:1rem;
      background:var(--panel); border-radius:1rem; box-shadow:0 2px 6px rgba(0,0,0,0.1);
    }
    #calendar h2 {margin-top:0;}
    .badge {display:inline-block; padding:0.25rem 0.5rem; border-radius:6px; color:#fff; font-size:0.75rem;}
    .aa {background:#16a34a;} .na {background:#ea580c;}
    .svc {background:#2563eb;} .holy {background:#facc15; color:#000;}
  </style>
</head>
<body>
  <header>
    <h1>Trinity Episcopal Church â€” De Soto, MO</h1>
    <p>Worship Services, AA/NA Meetings, and Community Events</p>
    <a class="view-calendar-btn" href="calendar.html">ðŸ“… View Full Calendar</a>
  </header>

  <main id="calendar">
    <h2>Calendar</h2>
    <div id="calendar-app">Loading calendarâ€¦</div>
  </main>

  <section id="upcoming">
    <h2>Upcoming Events</h2>
    <ul id="upcoming-list"></ul>
  </section>

  <footer id="legend">
    <p><span class="badge aa">AA 148 / 147</span> 
       <span class="badge na">NA</span> 
       <span class="badge svc">Sunday Service</span> 
       <span class="badge holy">Holy Day</span></p>
    <p>Trinity Episcopal Church, 202 W. Miller St., De Soto, MO 63020 Â· (636) 586-2542</p>
  </footer>

  <script>
    const ASSETS_VERSION = 302;
    const EVENTS_URLS = [
      `assets/events.json?v=${ASSETS_VERSION}`
    ];

    async function loadEvents() {
      let events = [];
      for (const url of EVENTS_URLS) {
        try {
          const res = await fetch(url);
          if (!res.ok) throw new Error(res.status);
          const data = await res.json();
          events = events.concat(data);
        } catch (err) {
          console.error("Failed to load", url, err);
        }
      }
      return events;
    }

    function renderCalendar(events) {
      const container = document.getElementById("calendar-app");
      container.innerHTML = "";
      // For now, simple list (replace with full grid if desired)
      const ul = document.createElement("ul");
      events.forEach(ev => {
        const li = document.createElement("li");
        li.textContent = ev.title + (ev.start ? " â€” " + ev.start : "");
        ul.appendChild(li);
      });
      container.appendChild(ul);

      // Upcoming section
      const upcomingList = document.getElementById("upcoming-list");
      upcomingList.innerHTML = "";
      events.slice(0,10).forEach(ev => {
        const li = document.createElement("li");
        li.textContent = (ev.start ? ev.start.slice(0,10) + " â€” " : "") + ev.title;
        upcomingList.appendChild(li);
      });
    }

    loadEvents().then(events => renderCalendar(events));
  </script>
</body>
</html>
